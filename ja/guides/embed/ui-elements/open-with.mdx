---
title: "Content Open With"
rank: 7
related_endpoints: []
related_guides:
  - embed/ui-elements
required_guides:
  - embed/ui-elements/installation
related_resources: []
alias_paths:
  - /docs/box-content-open-with
category_id: embed
subcategory_id: embed/ui-elements
is_index: false
id: embed/ui-elements/open-with
type: guide
total_steps: 18
sibling_id: embed/ui-elements
parent_id: embed/ui-elements
next_page_id: embed/ui-elements/preview
previous_page_id: embed/ui-elements/explorer-metadata-v1
source_url: >-
  https://github.com/box/developer.box.com/blob/main/content/guides/embed/ui-elements/open-with.md
fullyTranslated: true
---

<Warning>

日本時間 2021 年 12 月 22 日をもって、新規のお客様に対する`OpenWith` UI Element のサポートは終了しました。

</Warning>

Box Content Open With UI Element を使用すると、開発者は、Box に保存されているコンテンツをパートナーアプリケーションまたはローカルのデスクトップで開くためのドロップダウンを埋め込むことができます。

この Element は、有効化された統合に関する情報を Box API を使用して取得し、パートナーのサービスを呼び出します。その後、ユーザーはこれらのサービスで操作を行うと、編集したコンテンツは Box に自動的に保存されます。

Open With Element に含まれる統合には、Google Suite および Box Edit があります。Google Suite の統合の詳細については、[Box コミュニティサイト][community]を参照してください。

現在、この要素では、認証用に[App User](https://developer.box.com/platform/user-types)のみがサポートされています。

## インストール

NPM または Box CDN 経由で Box UI Elements をインストールする方法は、[こちら](/ja/guides/embed/ui-elements/installation)を参照してください。

## Box Edit

Box Edit では、Platform アプリケーションに統合するために追加の設定が必要です。Box Edit は、デスクトップアプリケーションの[Box Tools][tools]を使用してコンテンツをローカルで開きます。

- リクエストでは (`https`ドメインからの) セキュアな接続を使用する必要があります。
- アプリケーションのドメインは、Box Tools で許可する必要があります。手順については、[こちら][custom-domains]を参照してください。理想的なワークフローでは、Box Tools もインストールされるインストーラにこれらの手順をバンドルします。
- Safari では、Box Tools に接続するためにブラウザの機能拡張が必要です。詳細については、[こちら][safari]を参照してください。

## G Suite

Box for G Suite の統合を使用するには、有効な G Suite アカウントが必要です。ユーザーの G Suite と Box アカウントを接続するには、App User の`external_app_user_id`を、ユーザーの G Suite アカウントに関連付けられたメールアドレスに更新する必要があります。

App User の`external_app_user_id`は、[`PUT /users/:id`](/ja/reference/put-users-id)エンドポイントを介して更新できます。

## 設定

Open With UI Element を使用する前に、アプリケーションを許可し、Box API エンドポイントを使用して App User のために統合を有効にしておく必要があります。

### アプリケーションのアクティブ化

「Open With」UI Element は、Box Platform を使用して構築するすべての開発者が使用できます。インスタンスに対してこの要素をアクティブ化するには、開発者コンソールでアプリケーションに \[統合を有効化] スコープを追加します。

<Frame border>

![統合を有効化](/images/guides/embed/ui-elements/enable-integrations.png)

</Frame>

アプリケーションは、API コールに対してアクティブ化されたら、会社での再認証が必要になります。この操作を実行する手順については、[こちら](/ja/guides/authorization/platform-app-approval)を参照してください。

## 使用可能な統合のリストの取得

アプリ統合をユーザーに割り当てるには、まず、使用可能な統合のリストを取得します。この`GET`リクエストは、次の`cURL`リクエストを使用して実行できます。

```sh
curl -X GET https://api.box.com/2.0/app_integrations \
    -H 'Authorization: Bearer [ACCESS_TOKEN]'

```

```json
{
  "next_marker": null,
  "entries": [
    { "type": "app_integration", "id": "10897" },
    { "type": "app_integration", "id": "1338" },
    { "type": "app_integration", "id": "13418" },
    { "type": "app_integration", "id": "3282" }
  ],
  "limit": 100
}
```

アプリ統合 ID を使用して、指定したユーザーに統合を割り当てます。

## 特定の統合の取得

ID に基づいて、特定の統合に関する追加情報を取得するには、次の GET リクエストを実行できます。

```sh
curl -X GET \
    https://api.box.com/2.0/app_integrations/[APP_INTEGRATION_ID] \
    -H 'Authorization: Bearer [ACCESS_TOKEN]'

```

```json
{
  "type": "app_integration",
  "id": "10897",
  "app": {
    "type": "app",
    "id": "336417"
  },
  "name": "Edit with G Suite",
  "description": "Securely manage your Google Docs, Sheets and Slides in Box",
  "executable_item_types": ["file"],
  "restricted_extensions": ["docx", "gdoc", "xlsx", "gsheet", "pptx", "gslides", "gslide"],
  "scoped_to": "parent"
}
```

## ユーザーへの統合の追加

有効な App User にアプリ統合を追加するには、以下の 3 つの情報が必要です。

- 有効な[サービスアカウント](https://developer.box.com/platform/user-types/#service-account)アクセストークン
- 統合を割り当てる App User の ID
- ユーザーに割り当てるアプリ統合の ID

<Warning>

アプリ統合に関する情報を取得するための前述の 2 つのリクエストは、有効な開発者トークンなど、任意の有効なトークンを使用して実行できますが、アプリ統合を追加および削除するには、有効なサービスアカウントのアクセストークンが必要です。開発者トークンを使用すると`404 Not Found`エラーが発生します。

</Warning>

アプリ統合を App User に割り当てるには、次の`POST`リクエストを実行できます。

```sh
curl -X POST https://api.box.com/2.0/app_integration_assignments \
    -H 'Authorization: Bearer [SERVICE_ACCOUNT_TOKEN]' \
    -d '{
      "assignee": {
        "type": "user",
        "id": "[APP_USER_ID]"
      },
      "app_integration": {
        "type": "app_integration",
        "id": "[APP_INTEGRATION_ID]"
      }
    }'

```

```json
{
  "type": "app_integration_assignment",
  "id": "72048301",
  "assignee": {
    "type": "user",
    "id": "6084519920"
  },
  "app_integration": {
    "type": "app_integration",
    "id": "3282"
  }
}
```

JSON レスポンスに含まれる ID は、割り当て後にアプリ統合を管理するために使用できるため、アプリケーションで保存する必要があります。

## ユーザーからの統合の削除

App User からアプリ統合を削除するには、有効なサービスのアクセストークンと、前の手順で取得したアプリ統合割り当て ID を使用して次のリクエストを実行できます。

```sh
curl -X DELETE https://api.box.com/2.0/app_integration_assignments/[APP_INTEGRATION_ASSIGNMENT_ID] \
    -H 'Authorization: Bearer [SERVICE_ACCOUNT_TOKEN]'

```

```sh
204 No Content

```

## サンプル HTML

```html
<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <title>Box Content Open With Demo</title>

    <!-- Latest version of the open with css for your locale -->
    <link rel="stylesheet" href="https://cdn01.boxcdn.net/platform/elements/{VERSION}/en-US/openwith.css" />
  </head>
  <body>
    <div class="container" style="height:600px"></div>
    <!-- Latest version of the open with js for your locale -->
    <script src="https://cdn01.boxcdn.net/platform/elements/{VERSION}/en-US/openwith.js"></script>
    <script>
      var fileId = "123";
      var accessToken = "abc";
      var contentOpenWith = new Box.ContentOpenWith();
      contentOpenWith.show(fileId, accessToken, {
        container: ".container",
      });
    </script>
  </body>
</html>
```

## デモ

### Open With の例

<iframe height="560" scrolling="no" title="Box Open Withの例" src="//codepen.io/box-platform/embed/984598a6fe6bf01785d02be770c5c96a/?height=560&theme-id=27216&default-tab=result&embed-version=2&editable=true" frameborder="no" allowtransparency allowfullscreen style={{width: "100%"}}>

</iframe>

### コンテンツエクスプローラと Open With の例

<iframe height="560" scrolling="no" title="Box Content Explorerの例とOpen With" src="//codepen.io/box-platform/embed/519f67ba709fb581a93c3f73b64cf223/?height=560&theme-id=27216&default-tab=result&embed-version=2&editable=true" frameborder="no" allowtransparency allowfullscreen style={{width: "100%"}}>

</iframe>

<Info>
**アクセストークン**

上記のデモは、デモの \[JS] タブで有効なアクセストークンを指定しなければ、十分に機能しない可能性があります。Open With Element の場合は、有効な[サービスアカウント][service-account]アクセストークンを指定する必要があります。

</Info>

## 認証

UI Element は認証に依存しない方法で設計されているため、Box アカウントを持つユーザー (管理対象ユーザー) と Box 以外のアカウントを持つユーザー (App User) のどちらに UI Element を使用するかどうかに関係なく、UI Element を使用するのに特別な設定は必要ありません。その理由は、UI Element は認証のために「トークン」を受け取ることのみを予期しており、Box にはトークンの生成方法として OAuth と JWT の 2 つがあるからです。

<Card href="/ja/guides/authentication/select" title="認証方法の選択について確認する" />

## スコープ

ダウンスコープされたトークンを使用して統合を実行するには、`item_execute_integration`スコープに加えて、使用する特定の統合で必要となるスコープを含める必要があります。

- **Google**: 親フォルダに対する`item_readwrite`
- **Adobe**: `root_readwrite`
- **Box Edit**: 親フォルダに対する`item_readwrite`
- **Box Edit 単一ファイルコラボレーション**: ファイルに対する`item_readwrite`

スコープの詳細については、[こちら][scopes]を参照してください。

## API

```js
const { ContentOpenWith } = Box;
const contentOpenWith = new ContentOpenWith();

/**
 * Shows the content open with element.
 *
 * @param {string} fileId - The root file id
 * @param {string} accessToken - Box API access token
 * @param {Object} [options] - Options
 * @return {void}
 */
contentOpenWith.show(fileId, accessToken, options);

/**
 * Hides the content open with element, removes all event listeners,
 * and clears out the
 * HTML.
 *
 * @return {void}
 */
openWith.hide();

/**
 * Adds an event listener to the content open with element. Listeners should be added
 * before calling show() so no events are missed.
 *
 * @param {string} eventName - Name of the event
 * @param {Function} listener - Callback function
 * @return {void}
 */
contentOpenWith.addListener(eventName, listener);

/**
 * Removes an event listener from the content open with element.
 *
 * @param {string} eventName - Name of the event
 * @param {Function} listener - Callback function
 * @return {void}
 */
contentOpenWith.removeListener(eventName, listener);

/**
 * Removes all event listeners from the content open with element.
 *
 * @return {void}
 */
contentOpenWith.removeAllListeners();
```

### パラメータ

| パラメータ    | 型     | 説明                                                                                                                                                                                                                           |
| ------------- | ------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `fileId`      | String | Box ファイル ID。統合の実行対象となるファイルの ID です。                                                                                                                                                                      |
| `accessToken` | String | 使用する Box API アクセストークン。このトークンには、上記のフォルダに対する読み取り/書き込みアクセス権限が必要です。このトークンのために渡される値は、エクスプローラの表示中は有効期限切れにならないことが前提となっています。 |
| `options`     | Object | 省略可能なオプション。詳細は以下を参照してください。たとえば、`contentExplorer.show(FOLDER_ID, TOKEN, {canDelete: false})`を使用すると、削除オプションが非表示になります。                                                     |

### オプション

{/* i18n-enable localize-links */}

| パラメータ            | 型         | 説明                                                                                                                                                                                                                                                                       |                                                                                   |
| --------------------- | ---------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------- |
| `dropdownAlignment`   | \`left     | right\`                                                                                                                                                                                                                                                                    | \[開く] ボタンに対するドロップダウンの位置を決定します。デフォルトは`right`です。 |
| `boxToolsName`        | `String`   | この文字列は、「このファイルをデスクトップで開くには Box Tools をインストールしてください」というメッセージ内の Box Tools の名前に置き換わります。                                                                                                                         |                                                                                   |
| `boxToolsInstallUrl`  | `String`   | この URL は、「このファイルをデスクトップで開くには Box Tools をインストールしてください」というメッセージ内でリンクされている、デフォルトの Box インストール手順の代わりに使用されます。                                                                                  |                                                                                   |
| `onExecute`           | `Function` | 統合の呼び出しが試行されたときに実行されるコールバック。                                                                                                                                                                                                                   |                                                                                   |
| `onError`             | `Function` | エラーが発生したときに実行されるコールバック。                                                                                                                                                                                                                             |                                                                                   |
| `requestInterceptor`  | `Function` | リクエストをインターセプトする関数。例については、[この CodePen](https://codepen.io/box-platform/pen/jLdxEv)を参照してください。基盤となる XHR ライブラリは`axios.js`で、[インターセプタでは同様のアプローチ](https://github.com/axios/axios#interceptors)に従っています。 |                                                                                   |
| `responseInterceptor` | `Function` | レスポンスをインターセプトする関数。例については、[この CodePen](https://codepen.io/box-platform/pen/jLdxEv)を参照してください。基盤となる XHR ライブラリは`axios.js`で、[インターセプタでは同様のアプローチ](https://github.com/axios/axios#interceptors)に従っています。 |                                                                                   |

{/* i18n-disable localize-links */}

<Warning>

現在、`onError`イベントと`onExecute`イベントは、既知のバグの影響を受けています。一時的な回避策として`openWith.addListener('execute', callback)`および`openWith.addListener('error', callback)`を使用することをお勧めします。

</Warning>

### イベント

| イベント名 | イベントデータ | 説明                                         |
| ---------- | -------------- | -------------------------------------------- |
| `execute`  | 統合 ID        | 統合の呼び出しが実行されたときに発生します。 |
| `error`    | エラー         | エラーが発生したときに発生します。           |

[scopes]: /ja/guides/api-calls/permissions-and-errors/scopes

{/* i18n-enable localize-links */}

[community]: https://support.box.com/hc/ja/articles/360043696994-Box-for-Google-Workspaceについて
[tools]: https://support.box.com/hc/ja/categories/360003188014-Box-Tools

{/* i18n-disable localize-links */}

[custom-domains]: /ja/guides/embed/ui-elements/custom-domains

{/* i18n-enable localize-links */}

[safari]: https://support.box.com/hc/ja/articles/360043697334-Box-Toolsのインストール

{/* i18n-disable localize-links */}

[service-account]: /ja/platform/user-types/#service-account
