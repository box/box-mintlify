---
title: "ウェブアプリ統合の作成"
rank: 3
related_endpoints: []
related_guides:
  - authentication/oauth2/oauth2-setup
  - authentication/tokens
  - applications/integrations
required_guides: []
related_resources: []
alias_paths: []
notes: Needs a massive cleanup
category_id: applications
subcategory_id: applications/web-app-integrations
is_index: false
id: applications/web-app-integrations/configure
type: guide
total_steps: 3
sibling_id: applications/web-app-integrations
parent_id: applications/web-app-integrations
next_page_id: applications/web-app-integrations
previous_page_id: applications/web-app-integrations/user-experience
source_url: >-
  https://github.com/box/developer.box.com/blob/main/content/guides/applications/web-app-integrations/configure.md
fullyTranslated: true
---

このガイドでは、Platform アプリとのウェブアプリ統合を設定する方法について説明します。

<Warning>

サーバー側統合のサポートは終了しました。つまり、サーバー側の処理を使用するアプリケーションは引き続き動作しますが、事前コールバックの URL や Basic 認証など、サーバー側の構成オプションを変更することはできなくなります。これらのオプションを無効化し、実装を新しいものに変更できます。

</Warning>

## OAuth 2.0 アプリケーションの作成

[開発者コンソール][devconsole]に移動し、[OAuth 2.0 認証][custom-oauth2]を利用する[Platform アプリ][ca]を作成します。

## 新しい統合の作成

次に、\[**統合**] タブに移動し、\[**ウェブアプリ統合を作成**] をクリックします。

<Frame center shadow border>

![[統合] タブ](./images/create_integration.png)

</Frame>

## 統合の構成

統合を構成するには、各値について、以下のガイダンスに従います。

### アプリ情報

| フィールド                                                                             | 説明                                                                                                                                                                                                                                                                           |
| -------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| 統合名                                                                                 | 統合の名前。ユーザーがファイルまたはフォルダの \[**その他のオプション**] > \[**統合**] メニューを選択したときに Box ウェブアプリに表示されます。                                                                                                                               |
| 説明                                                                                   | Box 統合に表示される統合の説明。                                                                                                                                                                                                                                               |
| サポートされているファイル拡張子                                                       | 統合は、選択されているファイル拡張子の \[**その他のオプション**] > \[**統合**] メニューのオプションとしてのみ表示されます。                                                                                                                                                    |
| 必要な権限                                                                             | ユーザーが統合を表示するために必要な権限を決定します。\[**ダウンロードの権限が必要**] にした場合、ユーザーはファイルをダウンロードできますが、そのファイルを更新することはできません。\[**すべての権限が必要**] にした場合、ユーザーはファイルのダウンロードと更新を行えます。 |
| 統合の範囲                                                                             | 統合の範囲を指定します。統合の呼び出し元となるファイル/フォルダ、またはその親フォルダを指定します。                                                                                                                                                                            |
| \[共有ページで表示] の切り替え                                                         | 共有ページで外部ユーザーに統合を表示可能にするかどうかを決定します。有効にした場合、コンテンツでコラボレーションしていないユーザーが共有リンクを介して項目にアクセスすると、コンテキストメニューに統合が表示されます。                                                         |
| \[ロックして、この統合を使用したファイルの上書きを現在のユーザーにのみ許可] の切り替え | 異なるウェブアプリ統合でファイルを同時に編集可能にするかどうかを決定します。                                                                                                                                                                                                   |
| 統合の種類                                                                             | 必要な統合の種類を選択します。使用できるオプションは、\[**ファイル**]、\[**フォルダ**]、\[**両方**] です。                                                                                                                                                                     |

### コールバック構成

| フィールド                     | 説明                                                                                                                                                                                                                                                                                                                                                                                |
| ------------------------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| クライアントコールバックの URL | [ポップアップ統合][pu]での最初のリクエストの後に、Box からの追加のコールバックリクエストを処理します。アプリケーションが REST メソッドでファイルパラメータを指定した場合、事前コールバックの URL はクライアントから発信できません。そのため、必要なインターフェースをサーバーがユーザーに送信できるように、2 番目のリクエストがクライアントからサーバーに送信される必要があります。 |
| プロンプトメッセージ           | ユーザーが統合を開始する際に表示されるメッセージを指定します。このフィールドを使用して、次に何が起こるかについてコンテキストを提供します。このメッセージは 500 文字に制限されています。                                                                                                                                                                                             |
| ユーザーエクスペリエンス       | 統合が新しいウィンドウで開くことを通知します。                                                                                                                                                                                                                                                                                                                                      |
| 新しいウィンドウの設定         | アプリケーションを新しいタブで開くかどうかを決定します。                                                                                                                                                                                                                                                                                                                            |

### コールバックパラメータ

\[**コールバックパラメータ**] セクションでは、ユーザーが確認プロンプトを受け入れると Box からコールバック URL に送信されるパラメータを構成します。この設定が構成されていない場合、Box からコールバック URL にパラメータが送信されません。パラメータを追加するには、\[**メソッド**] (GET または POST) を選択し、\[**パラメータ名**] を指定して、\[**パラメータ値**] を追加します。

<Warning>

**File**メソッドのサポートは終了しました。すでにこのメソッドを使用している場合は、その値を編集できません。**File**メソッドを**GET**または**POST**に変更することはできますが、この操作を元に戻すことはできません。

</Warning>

例: **GET - `userid` - `#user_id#`**。

以下のパラメータ値が使用可能です。

| パラメータ            | メソッド  | 説明                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| --------------------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `user_id`             | GET、POST | Box[ユーザー ID][uid]。この情報は、アクションを完了するためにユーザー認証が必要なポップアップ統合で使用されます。Box ID をアプリケーションに保存すると、統合からの後続の認証リクエストを有効にできます。                                                                                                                                                                                                                                                                                                                                                         |
| `user_name`           | POST      | Box ユーザーのフルネームまたはメールアドレス。Box ユーザーが常に自分の名前を指定しているとは限りません。                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| `file_id`             | GET、POST | Box[ファイル ID][fid]。この ID を使用すると、ファイルを操作する Box API コールを実行できます。                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `file_name`           | POST      | ファイルの名前。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `file_extension`      | GET、POST | ファイルの拡張子。                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `auth_code`           | GET、POST | OAuth 2.0[承認コード][code]。これは、認証の成功時に Box によって生成されます。その後、アプリケーションは、この承認コードを OAuth 2.0 アクセストークンの代わりに Box に指定する必要があります。有効なアクセストークンが含まれた承認ヘッダーをすべての Box API リクエストに含める必要があります。                                                                                                                                                                                                                                                                  |
| `redirect_to_box_url` | GET、POST | ポップアップ統合で、確認プロンプトによるリクエストの送信先となる URL。この URL を使用すると、ユーザーは \[すべてのファイル] ページにリダイレクトされます。このパラメータにより、ポップアップパネルが閉じ、\[すべてのファイル] ページは、統合による変更をすべて反映するよう更新されます。このパラメータをアプリケーションに追加しない場合は、URL 全体を指定できます。**成功**: `#redirect_to_box_url#&status=success&message=Your%20action%20was%20successful%2E`。**失敗**: `#redirect_to_box_url#&status=failure&message=Your%20action%20was%20unsuccessful%2E` |

### 統合ステータス

- **開発**: 統合は、\[**一般設定**] タブで表示されるアプリケーションコラボレータのみが表示および使用できます。このオプションは、アプリケーションがまだ開発中でテストの実施中である場合に最もよく使用されます。
- **オンライン**: 統合は、すべての Box ユーザーが表示し、使用できます。このオプションは、開発が完了し、アプリケーションを統合で公開する準備ができている場合に最もよく使用されます。
- **メンテナンス**: 統合は、\[**一般設定**] タブで表示されるアプリケーションコラボレータのみが表示および使用できます。このオプションは、統合が \[統合] で公開された後、メンテナンスでの更新を実行したり問題をトラブルシューティングしたりする必要がある場合に最もよく使用されます。このオプションを使用すると、アプリケーションのコラボレータ以外のすべてのユーザーに対して統合が一時的にオフラインになります。

## Box 統合のユースケースの例

ユーザーがポップアップ統合を選択すると、Box から事前コールバックの URL にコールバックリクエストが送信されます。これにより、構成済みのコールバックパラメータがサーバーに送信されます。クライアントが必要なデータを最初のリクエストからすべて取得できない場合は、Box が 2 番目のリクエストを送信することもあります。

次の例では、クライアントコールバックの URL が必要ありません。

- ポップアップ統合で、`download_file_url`コールバックパラメータを使用して REST 呼び出しを実行する。
- ユーザーが確認プロンプトで \[**OK**] をクリックしてポップアップを受け入れる。
- Box が次の URL にリクエストを送信する (事前コールバックの URL にコールバックパラメータを追加): `http://www.doceditor.com/service?apikey=abc&file=&redirect=`。
- コールバック URL からのレスポンスにより、リクエストを送信したユーザーにユーザーインターフェースが表示される。ポップアップには、アクションを続行するために必要なすべての情報が表示されているため、追加のクライアントコールバックは必要ありません。

次の例では、クライアントコールバックの URL が必要です。

- ポップアップ統合で、ファイルコールバックパラメータを使用して REST 呼び出しを実行する。
- ユーザーが確認プロンプトで \[**OK**] をクリックしてポップアップを受け入れる。
- ポップアップによって表示されたページで、Box からリモートサーバーに、ファイルのコンテンツを含む POST リクエストとともにコールバックパラメータが送信される。
- Box がリモートサーバーからレスポンスを受信し、クライアントにクライアントコールバックの URL へのレスポンスを投稿するよう指示する。この URL で識別されたサーバーがレスポンスを解釈し、適切なセッション ID を持つユーザーをリダイレクトします。

## クライアントコールバックの URL のリクエスト形式

Box からクライアントコールバックの URL に送信される POST リクエストは、事前コールバックの URL からレスポンスを取得し、元のコールバックと同じデータとともにレスポンスを同じ URL に転送します。

| クライアントコールバックの URL                                                                                             | 例                                                       |
| -------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------- |
| 2 つの GET パラメータと 1 つの POST パラメータ: `http://your-client-callback-url.com/?get_param1=value1&get_param2=value2` | `POST data: post_param1=value1initial_callback_response` |

クライアントコールバックリクエストへのレスポンスは HTTP ステータス 302 で、ユーザーは正しい URL にリダイレクトされるか、UI の HTML にリダイレクトされます。

ほとんどの場合、この URL は、ウェブアプリ統合のために開発された個々の API またはカスタムスクリプトを指します。これは、事前コールバックの URL の結果を解析します。また、この URL は、インターネット上で一般公開する必要があることに注意してください。

## 統合の一般公開

Box 統合を一般公開するには、統合を App Center に掲載する必要があります。詳細については、[統合][integrations]ガイドに従ってください。

[ca]: /ja/guides/applications/app-types/platform-apps
[pu]: /ja/guides/applications/web-app-integrations/types
[uid]: https://ja.developer.box.com/platform/appendix/locating-values/#user-ids
[fid]: https://ja.developer.box.com/platform/appendix/locating-values/#content-ids
[code]: /ja/guides/authentication/oauth2/without-sdk/#3-user-grants-application-access
[custom-oauth2]: /ja/guides/authentication/oauth2/oauth2-setup
[devconsole]: https://app.box.com/developers/console
[devaccount]: https://account.box.com/signup/n/developer
[integrations]: /ja/guides/applications/integrations
