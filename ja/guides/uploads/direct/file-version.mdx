---
related_pages: {}
title: ファイルバージョンのアップロード

fullyTranslated: true
---

import {Link} from "/snippets/Link.jsx";

import {RelatedLinks, MultiRelatedLinks} from "/snippets/related-links.jsx";

<RelatedLinks
  title="必須のガイド"
  items={[
  { label: "Preflight Check", href: "/guides/uploads/check", badge: "GUIDE" }
]}
/>

直接アップロードによってBoxにファイルの新しいバージョンをアップロードするには、ファイルのコンテンツ、目的のファイル名、フォルダIDを使用して、<Link href="/reference/post-files-id-content">`POST /files/:id/content`</Link> APIにAPIコールを実行します。

<CodeGroup>
  ```sh cURL
  curl -i -X POST "https://upload.box.com/api/2.0/files/12345/content" \
       -H "authorization: Bearer <ACCESS_TOKEN>" \
       -H "content-type: multipart/form-data" \
       -F attributes='{"name":"Contract.pdf", "parent":{"id":"11446498"}}' \
       -F file=@<FILE_NAME>
  ```

  ```typescript Node/TypeScript v10
  await client.uploads.uploadFileVersion(file.id, {
    attributes: {
      name: file.name!,
    } satisfies UploadFileVersionRequestBodyAttributesField,
    file: generateByteStream(20),
  } satisfies UploadFileVersionRequestBody);
  ```

  ```python Python v10
  client.uploads.upload_file_version(
      uploaded_file.id,
      UploadFileVersionAttributes(name=new_file_version_name),
      new_file_content_stream,
  )
  ```

  ```cs .NET v10
  await client.Uploads.UploadFileVersionAsync(fileId: uploadedFile.Id, requestBody: new UploadFileVersionRequestBody(attributes: new UploadFileVersionRequestBodyAttributesField(name: newFileVersionName), file: newFileContentStream));
  ```

  ```java Java v10
  client.getUploads().uploadFileVersion(uploadedFile.getId(), new UploadFileVersionRequestBody(new UploadFileVersionRequestBodyAttributesField(newFileVersionName), newFileContentStream))
  ```

  ```java Java v5
  BoxFile file = new BoxFile(api, "id");
  FileInputStream stream = new FileInputStream("My File.txt");
  file.uploadNewVersion(stream);
  ```

  ```python Python v4
  file_id = '11111'
  file_path = '/path/to/file.pdf'

  updated_file = client.file(file_id).update_contents(file_path)
  print(f'File "{updated_file.name}" has been updated')
  ```

  ```cs .NET v6
  using (FileStream fileStream = new FileStream(filePath, FileMode.Open))
  {
      BoxFile file = await client.FilesManager
          .UploadNewVersionAsync("File v2.pdf", "11111", fileStream);
  }
  ```

  ```javascript Node v4
  var fs = require('fs');
  var stream = fs.createReadStream('/path/to/file.pdf');
  client.files.uploadNewFileVersion('11111', stream)
  	.then(file => {
          /* file -> {
              total_count: 1,
              entries: 
              [ { type: 'file',
                  id: '11111',
                  file_version: 
                      { type: 'file_version',
                      id: '22222',
                      sha1: '0beec7b5ea3f0fdbc95d0dd47f3c5bc275da8a33' },
                  sequence_id: '0',
                  etag: '0',
                  sha1: '0beec7b5ea3f0fdbc95d0dd47f3c5bc275da8a33',
                  name: 'My File.pdf',
                  description: '',
                  size: 68431,
                  path_collection: 
                      { total_count: 1,
                      entries: 
                      [ { type: 'folder',
                          id: '0',
                          sequence_id: null,
                          etag: null,
                          name: 'All Files' } ] },
                  created_at: '2017-05-16T15:18:02-07:00',
                  modified_at: '2017-05-16T15:18:02-07:00',
                  trashed_at: null,
                  purged_at: null,
                  content_created_at: '2017-05-16T15:18:02-07:00',
                  content_modified_at: '2017-05-16T15:18:02-07:00',
                  created_by: 
                      { type: 'user',
                      id: '33333',
                      name: 'Test User',
                      login: 'test@example.com' },
                  modified_by: 
                      { type: 'user',
                      id: '33333',
                      name: 'Test User',
                      login: 'test@example.com' },
                  owned_by: 
                      { type: 'user',
                      id: '33333',
                      name: 'Test User',
                      login: 'test@example.com' },
                  shared_link: null,
                  parent: 
                      { type: 'folder',
                      id: '0',
                      sequence_id: null,
                      etag: null,
                      name: 'All Files' }
                  item_status: 'active' } ] }
          */
      })
  ```
</CodeGroup>

<Info>
  **事前チェック**

  アップロードしたファイルが拒否されることによる時間や帯域幅の無駄を防ぐため、ファイルをアップロードする前に<Link href="/guides/uploads/check">事前チェック</Link>を実行することをお勧めします。
</Info>

## リクエスト形式

このAPIのリクエスト本文には、`multipart/form-data`のコンテンツタイプが使用されます。これを使用して、ファイル属性とファイルの実際のコンテンツの2つの部分を送信します。

最初の部分は`attributes`と呼ばれ、ファイル名や親フォルダの`id`など、ファイルに関する情報を含むJSONオブジェクトが含まれています。

以下の例では、ユーザーのルートフォルダに`test.txt`をアップロードしています。

```sh
POST /api/2.0/files/123/content HTTP/1.1
Host: upload.box.com
Authorization: Bearer [ACCESS_TOKEN]
content-length: 343
content-type: multipart/form-data; boundary=------------------------9fd09388d840fef1

--------------------------9fd09388d840fef1
content-disposition: form-data; name="attributes"

{"name":"test.txt", "parent":{"id":"0"}}
--------------------------9fd09388d840fef1
content-disposition: form-data; name="file"; filename="test.txt"
content-type: text/plain

Test file text.

--------------------------9fd09388d840fef1--
```

<Warning>
  マルチパート本文の`attributes` JSON部分は、マルチパートフォームデータの`file` 部分の前に置く必要があります。この順番を間違えると、APIがHTTP `400`ステータスコードとエラーコード`metadata_after_file_contents`を返します。
</Warning>

## オプション

ファイルのアップロード時に使用できるすべてのパラメータの詳細については、<Link href="/reference/post-files-id-content">このAPIコールに関するリファレンスドキュメント</Link>を参照してください。パラメータには、設定することで転送中のファイルの破損を防ぐ`content-md5`や、アップロード時間とは異なる時間をファイル作成時間として明示的に指定できる機能が含まれます。

ファイルバージョンの場合、追加の<Link href="/guides/api-calls/ensure-consistency">`if-match`ヘッダー</Link>を渡すことで、アプリケーションが最後にコンテンツを検査した後で更新されたファイルが上書きされるのを防ぐことができます。

## 制約事項

直接アップロードできるファイルサイズの上限は50 MBです。ファイルがこれより大きい場合は、<Link href="/guides/uploads/chunked">分割アップロードAPI</Link>を使用してください。

アップロードの上限は、認証済みユーザーのアカウントの種類によって決まります。詳細については、このトピックに関する[Boxコミュニティの記事][fsizes]を参照してください。

{/* i18n-enable localize-links */}

[fsizes]: https://support.box.com/hc/ja/articles/360043697314-Boxにアップロードできる最大ファイルサイズ

{/* i18n-disable localize-links */}

<RelatedLinks
  title="関連するAPI"
  items={[
  { label: "Upload file version", href: "/reference/post-files-id-content", badge: "POST" }
]}
/>
