---
related_pages:
  0: sdks-and-tools
title: メタデータの抽出

fullyTranslated: true
---

import {Link} from "/snippets/Link.jsx";

import {RelatedLinks, MultiRelatedLinks} from "/snippets/related-links.jsx";

<RelatedLinks
  title="必須のガイド"
  items={[
  { label: "Setup with OAuth 2.0", href: "/guides/authentication/oauth2/oauth2-setup", badge: "GUIDE" }
]}
/>

このスクリプトでは、任意のBoxフォルダ内のすべてのファイルとフォルダのメタデータの詳細を抽出し、その結果を各メタデータテンプレートのCSVスプレッドシートに保存します。

## 前提条件

### Windows

[.NET Core](https://dotnet.microsoft.com/download)の最新バージョンのインストール

### macOSおよびLinux

[PowerShell][pwsh]をインストールします。`pwsh`コマンドを実行して、インストール結果をテストします。

```bash
pwsh
```

どのディレクトリでこのコマンドを実行するかに応じて、出力が異なる場合があります。以下に例を示します。

```bash
PowerShell 7.2.5
Copyright (c) Microsoft Corporation.

https://aka.ms/powershell
Type 'help' to get help.

PS /Users/user/repos/boxcli/examples>
```

<Info>
  問題が発生する場合は、[.NET Core](https://dotnet.microsoft.com/download)と[PowerShell][pwsh]の両方をインストールしたかどうか確認してください。
</Info>

### Box CLI

スクリプトを使用するには、Box CLIをインストールし、構成する必要があります。これは、<Link href="/guides/cli/quick-start/create-oauth-app">クイックスタートガイド</Link>の手順を実行することで行うことができます。

## スクリプトの構成

1. `boxcli` GitHubリポジトリを複製してこの例のフォルダにcdコマンドで移動するか、[`examples`][examples]ディレクトリからファイルをダウンロードします。

   ```bash
   git clone https://github.com/box/boxcli.git
   cd boxcli/examples/Metadata\ Extraction/
   ```

2. `folderID`および`userID`パラメータを指定して、スキャンするフォルダとスクリプトを実行するユーザーをスクリプトに指示します。

   ```bash
   [string]$FolderID = "",
   [string]$UserID = "",
   ```

   パラメータをスクリプトで直接指定しない場合は、フラグとして渡すか、スクリプトで入力を求めるプロンプトを表示することができます。フラグを使用したコマンドのサンプルは次のようになります。

   ```bash
   ./Metadata-extraction.ps1 -folderId 123456789 -userId 123456789
   ```

## スクリプトの実行

1. PowerShellコマンドを実行します。

   ```bash
   pwsh
   ```

2. スクリプトを実行します。

   ```bash
   ./Metadata-extraction.ps1 -folderId 123456789 -userId 123456789
   ```

   スクリプトが終了すると、以下のような出力が表示されます。

   ```bash
   Pulling data from Folder ID: 173961139760
   metadata as user ID: 20718545815
   Reading Item ID: 1016853559790
   Metadata saved to: MetadataTemplate_properties.csv
   ```

## ログ

ログは、メインフォルダ内の`logs`フォルダに格納されます。以下のログファイルにアクセスできます。

* `Metadata-extraction_all.txt`: すべてのログエントリが含まれています。
* `Metadata-extraction_errors.txt`: エラーのみが含まれています。

[scripts]: https://github.com/box/boxcli/tree/main/examples

[pwsh]: https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell?view=powershell-7.2

[console]: https://app.box.com/developers/console

[auth]: /guides/authentication/oauth2/oauth2-setup

[examples]: https://github.com/box/boxcli/tree/main/examples/Metadata%20Extraction

<RelatedLinks
  title="関連するガイド"
  items={[
  { label: "OAuth 2.0 Auth", href: "/guides/authentication/oauth2/index", badge: "GUIDE" },
  { label: "Using PowerShell Scripts with the Box CLI", href: "/guides/cli/quick-start/powershell-script-templates", badge: "GUIDE" }
]}
/>
