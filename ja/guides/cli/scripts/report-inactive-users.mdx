---
related_pages:
  0: sdks-and-tools
title: 非アクティブなユーザーのレポート

fullyTranslated: true
---

import {Link} from "/snippets/Link.jsx";

import {RelatedLinks, MultiRelatedLinks} from "/snippets/related-links.jsx";

<RelatedLinks
  title="必須のガイド"
  items={[
  { label: "Setup with OAuth 2.0", href: "/guides/authentication/oauth2/oauth2-setup", badge: "GUIDE" }
]}
/>

このスクリプトは、一定の日数の間非アクティブであったユーザーのリストをCSVファイルで生成します。スクリプトによって以下の手順が実行されます。

1. `user`ロールを持つユーザーを探します。

   <message>
     このスクリプトでは、他のロール (`AppUser`など) は考慮していません。
   </message>

2. <Link href="/reference/resources/event">Box Events</Link>を使用して、そのユーザーが一定の日数の間に操作を行ったかどうかを確認します。デフォルトのイベントタイプのリストは、`LOGIN`、`UPLOAD`、`COPY`、`MOVE`、`PREVIEW`、`DOWNLOAD`、`EDIT`、`DELETE`、`UNDELETE`、`LOCK`、`UNLOCK`、`NEW_USER`です。このリストはスクリプトの設定で変更できます。

3. 操作を行わなかったユーザーを、非アクティブなユーザーが含まれている`.csv`ファイルに追加します。このファイルは他のスクリプト (<Link href="/guides/cli/scripts/deprovision-users">ユーザーのプロビジョニング解除</Link>など) の入力として使用できます。

## 前提条件

### Windows

[.NET Core](https://dotnet.microsoft.com/download)の最新バージョンのインストール

### macOSおよびLinux

[PowerShell][pwsh]をインストールします。`pwsh`コマンドを実行して、インストール結果をテストします。

```bash
pwsh
```

どのディレクトリでこのコマンドを実行するかに応じて、出力が異なる場合があります。以下に例を示します。

```bash
PowerShell 7.2.5
Copyright (c) Microsoft Corporation.

https://aka.ms/powershell
Type 'help' to get help.

PS /Users/user/repos/boxcli/examples>
```

<message>
  問題が発生する場合は、[.NET Core](https://dotnet.microsoft.com/download)と[PowerShell][pwsh]の両方をインストールしたかどうか確認してください。
</message>

### Box CLI

スクリプトを使用するには、Box CLIをインストールし、構成する必要があります。これは、<Link href="/guides/cli/quick-start/create-oauth-app">クイックスタートガイド</Link>の手順を実行することで行うことができます。ログインに使用するユーザーは、Boxのメイン管理者または共同管理者である必要があります。

## スクリプトの構成

1. `boxcli` GitHubリポジトリを複製してこの例のフォルダにcdコマンドで移動するか、[`examples`][examples]ディレクトリからファイルをダウンロードします。

   ```bash
   git clone https://github.com/box/boxcli.git
   cd boxcli/examples/Inactive\ Users\ Report/
   ```

2. スクリプトでUser Eventをスキャンする日数を設定します。この値を指定しなかった場合やデフォルト設定のままにした場合は、スクリプトによって入力するよう求められます。

   ```bash
   $daysInactive = "10"
   ```

3. (省略可) レポート出力ファイル名を変更するには、`ReportOutputFile`パラメータを定義します。

   ```bash
   $ReportOutputFile = $ReportName + ".csv"
   ```

4. (省略可) イベントタイプを変更するには、`eventType`パラメータのリストを定義します。

   ```bash
   $eventType = "LOGIN,UPLOAD,COPY,MOVE"
   ```

## スクリプトの実行

PowerShellコマンドを実行します。

```bash
pwsh
```

スクリプトを実行します。

```bash
./Inactive_Users_Report.ps1
```

スクリプトの実行が完了すると、以下のような出力が表示されます。

```bash
Looking for users inactive for more than 3 days.
Found 6 users.
Found 7 events in last 3 days
Enterprise has: 0 App user, 6 regular users. With 1 admin role, 5 user roles.
Need to check 5 users (regular user, with user role) for inactive.
Found 5 users inactive for more than 3 days.
Report is available at InactiveUsers.csv
```

## ログ

ログは、メインフォルダ内の`logs`フォルダに格納されます。以下のログファイルにアクセスできます。

* `Inactive_Users_Report_all.txt`: すべてのログエントリが含まれています。
* `Inactive_Users_Report_errors.txt`: エラーのみが含まれています。

[scripts]: https://github.com/box/boxcli/tree/main/examples

[pwsh]: https://docs.microsoft.com/en-us/powershell/scripting/install/installing-powershell?view=powershell-7.2

[console]: https://app.box.com/developers/console

[auth]: /guides/authentication/oauth2/oauth2-setup

[examples]: https://github.com/box/boxcli/tree/main/examples/Inactive%20Users%20Report

<RelatedLinks
  title="関連するガイド"
  items={[
  { label: "OAuth 2.0 Auth", href: "/guides/authentication/oauth2/index", badge: "GUIDE" },
  { label: "Provision users and folders", href: "/guides/cli/scripts/provision-users-folders", badge: "GUIDE" },
  { label: "Deprovision users and archive folders", href: "/guides/cli/scripts/deprovision-users", badge: "GUIDE" },
  { label: "Update user zones", href: "/guides/cli/scripts/user-zones-mass-update", badge: "GUIDE" }
]}
/>
