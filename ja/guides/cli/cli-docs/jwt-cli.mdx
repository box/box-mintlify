---
title: "JWT認証を使用したBox CLI"
rank: 8
related_endpoints: []
related_guides:
  - authentication/jwt
  - authentication/jwt/jwt-setup
related_pages:
  - sdks-and-tools
required_guides:
  - authentication/jwt/jwt-setup
related_resources: []
alias_paths:
  - /guides/tooling/quick-start/create-jwt-app/
  - /guides/tooling/cli/jwt-cli
category_id: cli
subcategory_id: cli/cli-docs
is_index: false
id: cli/cli-docs/jwt-cli
type: guide
total_steps: 2
sibling_id: cli/cli-docs
parent_id: cli/cli-docs
next_page_id: cli/cli-docs
previous_page_id: ""
source_url: >-
  https://github.com/box/developer.box.com/blob/main/content/guides/cli/cli-docs/jwt-cli.md
fullyTranslated: true
---

これまで、[Box CLI のクイックスタートガイド][qs]では、JWT アプリケーションまたはサーバー認証アプリケーションの設定フローについて説明してきましたが、新しく OAuth 2.0 バージョンの Box CLI をリリースしたため、新機能の使用についてガイドを更新しました。当初の JWT の設定手順については、引き続きサーバー認証アプリケーションを使用したい方のために、こちらに移動しました。

## JWT アプリケーションの設定

サーバー認証を使用した CLI を使用するには、まず、[開発者コンソール][dc]で Box アプリケーションを作成します。CLI は API コールを実行する際にバックグラウンドでこのアプリケーションを使用できます。CLI を既存の JWT アプリケーションに関連付ける場合は、この手順を省略できます。ただし、少なくとも、以下のスコープがアプリケーションの \[**構成**] タブで設定されていることを確認してください。

- Box に格納されているすべてのファイルとフォルダの読み取り
- Box に格納されているすべてのファイルとフォルダへの書き込み

1. \[すべてのファイル] ページの左側にあるナビゲーションパネルから、[開発者コンソール][dc]を開きます。今回 Box API を使用するのが初めてで、このオプションがまだ使用できない場合は、[こちら][dc]をクリックするとこのオプションをアカウントに追加できます。

2. \[**Platform アプリの作成**] > \[**Platform アプリ**] > \[**サーバー認証 (JWT 使用)**] の順にクリックし、アプリケーションに名前を付けて、\[**アプリの作成**] をクリックします。

<Warning>

サーバー認証 (JWT 使用) は、使用する前に必ず管理者の承認が必要になります。

</Warning>

## アプリケーションの構成

これにより、アプリケーションの設定ページが表示され、そこで、そのアクセスや権限を選択する必要があります。アプリケーションの認証タイプが原因で、管理者の承認が必要になることにもう一度注意してください。

少なくとも、以下の[スコープ][scopes]が必要です。

- Box に格納されているすべてのファイルとフォルダの読み取り
- Box に格納されているすべてのファイルとフォルダへの書き込み

[アプリケーションアクセス][aa]として、\[アプリアクセスのみ] または \[アプリ + Enterprise アクセス] のいずれかを選択できます。

## アプリケーションの承認

API コールを正常に実行する前に、サーバー認証を利用するすべてのアプリケーションを管理コンソールで承認する必要があります。これは、すべての JWT アプリケーションには[サービスアカウント][sa]があるためです。サービスアカウントは、アプリケーションの[スコープ][scopes]に基づいて管理者アクションを実行できます。

開発者と管理者向けの手順については、Box の[承認ガイド][ag]を参照してください。

スコープ、アプリケーションアクセス、トークン、権限がどのように連携しているかの詳細については、[Box のセキュリティメカニズム][blogpost]に関する記事を参照してください。

<Warning>

設定の変更がこのアプリケーションに対して行われた場合は、その変更を有効にするためにこのアプリケーションを再承認する必要があります。

</Warning>

アプリケーションが使用できる状態になっているかどうかを確認するには、[開発者コンソール][dc]の \[承認] タブを表示します。状態とステータスはそれぞれ、\[有効] と \[承認済み] になっているはずです。

<Frame center>

![承認済みのアプリ](../images/app-authorized.png)

</Frame>

## 必要なデータのダウンロード

CLI では、API コールを実行するために、ローカルに保存されている構成ファイルが必要です。

構成ファイルをダウンロードするには、[開発者コンソール][dc]の \[**構成**] タブにアクセスし、\[**公開/秘密キーペアを生成**] をクリックします。これにより、アプリケーションの構成ファイルを自動的にダウンロードする前に 2 要素認証が行われます。詳細については、Box の[ガイド][keypair]を参照してください。

<Warning>

セキュリティ上の理由により、公開/秘密キーペアを生成するには、Box アカウントで 2 要素認証を有効にする必要があります。

</Warning>

`EnterpriseID_publicKeyID_config.json`という形式のデフォルトの名前が付いているダウンロード済みファイルをコンピュータ上で探します。この名前をそのまま使用しても、変更してもかまいません。このガイドでは、ファイルの名前を`config.json`に変更することを想定しています。

<Warning>

誤って削除または移動されることがない場所にファイルを配置することが重要です。ファイルが削除または移動された場合は、手順 2 を繰り返して CLI を再構成する必要があります。

</Warning>

## CLI のインストールと構成

Windows 用および macOS 用のインストーラが提供されていますが、その他の環境で CLI を構築する場合は Raw ソースコードを利用できます。

## Windows 用および macOS 用インストーラ

お使いのマシンに最新の CLI をインストールするには、最新リリースに対応する最新の`.exe` (Windows の場合) または`.pkg` (macOS の場合) をダウンロードします。

<Card href="https://github.com/box/boxcli/releases" title="最新のCLIインストーラをダウンロード" />

## Linux と Node のインストール

さらに、CLI は、任意のプラットフォーム (Linux など) に Node パッケージとしてインストールすることができます。このためには、[Node JS](https://nodejs.org/)をマシンにインストールしておく必要があります。

```bash
npm install --global @box/cli

```

## ソースコード

CLI のソースコードは、[GitHub][cli]で提供されています。

## 構成コマンドの実行

ここで、手順 1 でダウンロードした構成ファイルを指すよう、CLI を構成する必要があります。

<Frame center>

![CLIの構成図](../images/cli-config-diagram.png)

</Frame>

{/* alex ignore execute */}

ターミナルまたはコマンドラインを開き、`box configure:environments:add PathToConfigFileHere`コマンドを実行します。ここでは、`PathToConfigHere`を`config.json`ファイルのパスに置き換えます。

例: `box configure:environments:add /Users/ExampleUser/Documents/CLI/config.json`

<Tip>

Finder/エクスプローラからターミナル/コマンドラインウィンドウに csv ファイルをドラッグすると、パスを自動で入力できます。

</Tip>

## 構成の確認

うまく構成されているか確認するには、コマンド`box users:get`を使用します。

次のように、成功を示すレスポンスには、[アクセストークン][at]に関連付けられた[サービスアカウント][sa]ユーザーの詳細が示されます。

```json
Type: user
ID: ''0123456789''
Name: Box CLI - Quickstart Example
Login: AutomationUser_123456_8jSo6Lqvko@boxdevedition.com
Created At: '2020-01-01T09:45:01-07:00'
Modified At: '2021-03-01T09:30:05-07:00'
Language: en
Timezone: America/Los_Angeles
Space Amount: 999999999999999
Space Used: 6291500
Max Upload Size: 16106127360
Status: active
Job Title: ''
Phone: ''
Address: example+user@box.com
Avatar URL: ''
Notification Email: []

```

<Tip>

デフォルトでは、JWT アプリケーションはサービスアカウントのアクセストークンを自動的に取得します。デフォルトユーザーの変更は可能ですが、このガイドでは変更しないことを想定しています。

</Tip>

## 次の手順

- コード例を GitHub の[コマンド][commands]ページで確認できます。
- [OAuth 2.0 のクイックスタート][three]の 2 番目の手順に進み、コマンドの使用方法のチュートリアルを確認することもできます。

[cli]: https://github.com/box/boxcli
[auth]: /ja/guides/authentication/jwt/without-sdk
[at]: /ja/guides/authentication/tokens

{/* i18n-enable localize-links */}

[dc]: https://account.box.com/developers/console

{/* i18n-disable localize-links */}

[keypair]: /ja/guides/authentication/jwt/jwt-setup/#public-and-private-key-pair
[sa]: https://ja.developer.box.com/platform/user-types/#service-account
[scopes]: /ja/guides/api-calls/permissions-and-errors/scopes
[ag]: /ja/guides/authorization/platform-app-approval

{/* i18n-enable localize-links */}

[blogpost]: https://medium.com/box-developer-japan-blog/box-api-understanding-security-ja-b95725d8aaf0

{/* i18n-disable localize-links */}

[scopes]: /ja/guides/api-calls/permissions-and-errors/scopes
[aa]: /ja/guides/authentication/jwt/jwt-setup/#application-access
[three]: /ja/guides/cli/quick-start/build-commands-help
[four]: /ja/guides/cli/quick-start/options-and-bulk-commands
[cache]: https://github.com/box/boxcli/blob/master/docs/configure.md#box-configureenvironmentsupdate-name
[ac]: https://github.com/box/boxcli/blob/master/docs/autocomplete.md
[commands]: https://github.com/box/boxcli#command-topics
[qs]: /ja/guides/cli/quick-start
