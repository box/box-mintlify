---
alias_paths: ""
sidebarTitle: 概要
title: クライアント資格情報許可

fullyTranslated: true
---

import {Link} from "/snippets/Link.jsx";

import {RelatedLinks, MultiRelatedLinks} from "/snippets/related-links.jsx";

<RelatedLinks
  title="必須のガイド"
  items={[
  { label: "Select Auth Method", href: "/guides/authentication/select", badge: "GUIDE" }
]}
/>

サーバー認証を利用し、クライアントIDとクライアントシークレットを使用してアプリケーションのIDを確認する場合は、以下の手順に従います。

## 前提条件

* Box[開発者コンソール][devconsole]でサーバー認証 (クライアント資格情報許可使用) を使用するPlatformアプリケーション
* \[構成] タブからアプリケーションのクライアントシークレットを表示およびコピーするために、Boxアカウントで[2要素認証][2fa]が有効になっていること
* Box管理コンソールでアプリケーションが<Link href="/guides/authorization">承認</Link>されていること

<Danger>
  クライアントシークレットは機密情報であり、保護する必要があります。アクセストークンの取得時にBoxがアプリケーションのIDを安全に確認するために使用されるため、クライアントシークレットを自由に配布するべきではありません。配布方法には、メール、公開フォーラム、コードリポジトリ、分散されたネイティブアプリケーション、クライアント側のコードなどがあります。さらにセキュリティメカニズムを追加する場合は、Boxの標準的なJWTアプリケーションを使用することをお勧めします。
</Danger>

## 利用方法

APIコールを実行して<Link href="/reference/post-oauth2-token">アクセストークン</Link>を取得する際は、リクエスト本文にクライアントIDとクライアントシークレットを含める必要があります。`grant_type`を`client_credentials`に設定します。

アプリケーションの<Link href="/platform/user-types/#service-account">サービスアカウント</Link>として認証する場合は、以下のようにします。

* `box_subject_type`を`enterprise`に設定する
* `box_subject_id`をEnterprise IDに設定する

{/* <Samples id='x_auth' variant='with_client_credentials' /> */}

管理者または管理対象ユーザーとして認証する場合は、以下のようにします。

* `box_subject_type`を`user`に設定する
* `box_subject_id`をユーザーIDに設定する
* Box[開発者コンソール][devconsole]で \[**アプリ + Enterpriseアクセス**] および \[**ユーザーアクセストークンを生成する**] を有効にする

{/* <Samples id='x_auth' variant='with_ccg_admin_managed_user' /> */}

任意のアプリケーションユーザーとして認証する場合は、以下のようにします。

* `box_subject_type`を`user`に設定する
* `box_subject_id`をユーザーIDに設定する
* Box[開発者コンソール][devconsole]で \[**ユーザーアクセストークンを生成する**] を有効にする

{/* <Samples id='x_auth' variant='with_ccg_app_user' /> */}

## 一般的なエラー

{/* alex ignore invalid */}

### Grant credentials are invalid (許可の資格情報が無効です)

認証中に、次のエラーが表示される場合があります。

```sh
Grant credentials are invalid [400 Bad Request] invalid_grant - Grant credentials are invalid
```

このエラーは次のいずれかを示します。

* 渡されたクライアントIDとクライアントシークレットが正しくないか、同じアプリケーションのものではない。

* 選択した<Link href="/guides/authentication/client-credentials/client-credentials-setup/#application-access">アプリケーションアクセス</Link>に基づいて`box_subject_id`を使用できない。

<Warning>
  \[アプリアクセスのみ] が指定されているCCGアプリは、そのサービスアカウントとして認証するために送信時に`box_subject_type`を`enterprise`に設定できますが、管理対象ユーザーまたは管理者として認証できません。
</Warning>

* `box_subject_type`を`user`に設定して使用するには、\[**構成**] タブの \[**高度な機能**] セクションでユーザーアクセストークンを生成するようアプリケーションを構成する必要があります。

  <Frame>
    ![アクセストークンの生成のチェックボックス](/guides/authentication/client-credentials/image.png)
  </Frame>

<Warning>
  アプリの設定に変更を加えたら、忘れずに管理コンソールでアプリケーションを<Link href="/guides/authorization/platform-app-approval#re-authorization-on-changes">再承認</Link>してください。
</Warning>

* アプリケーションがBox管理コンソールで承認されていない

{/* i18n-enable localize-links */}

[2fa]: https://support.box.com/hc/ja/articles/360043697154-アカウントの多要素認証の設定

{/* i18n-disable localize-links */}

[devconsole]: https://app.box.com/developers/console

<RelatedLinks
  title="関連するAPI"
  items={[
  { label: "Authorize user", href: "/reference/get-authorize", badge: "GET" }
]}
/>

<RelatedLinks
  title="関連するガイド"
  items={[
  { label: "Select App Type", href: "/guides/applications/app-types/select", badge: "GUIDE" },
  { label: "Best Practices", href: "/guides/authentication/best-practices", badge: "GUIDE" }
]}
/>
