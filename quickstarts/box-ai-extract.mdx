---
title: Extract Structured Data with Box AI
description: Learn how to use Box AI to automatically extract structured data from documents and store it as searchable metadata using the Box Python SDK.
---

[Box AI](/ai-dev-zone) exposes intelligent extraction capabilities that enable developers to automatically extract structured
key-value pairs from documents through a single API call. This powerful feature transforms unstructured
document content into actionable metadata without manual data entry, streamlining document processing
workflows for invoices, forms, contracts, and other business documents.

This quickstart demonstrates how to configure the Box Python SDK, create a metadata template,
and use Box AI to extract invoice data and store it as searchable metadata in Box.

<Steps>
  <Step title="Create and configure a Box application">
    The first step for any Box Platform integration is to create and configure a Box 
    application. To create an app, go to [Box Developer Console](https://app.box.com/developers/console). 

    For this quickstart, create an App with the `Client Credentials Grant` 
    application type. Once the app is created, enable the following scopes:
    * `Read all files and folders stored in Box`
    * `Write all files and folders stored in Box`
    * `Manage AI`


    For more information about creating a new Box application, see [Create your first application](/guides/getting-started/first-application#create-your-first-application).
  </Step>
  <Step title="Create a Box metadata template">
    <Tip>
      This step requires Admin access to your Box Enterprise. If you do not have access
      in your current environment, contact your Box administrator.
    </Tip>

    Box AI enables you to extract data from documents in several ways:

    Type | Description | Use case
    ---|---|---
    Freeform extraction| Accepts a string prompt | Provide a natural language prompt
    Structured extraction with template | Accepts a Box Metadata template key | Define fields and data types once; makes pushing back to Box as metadata easy
    Structured extraction with fields | Accepts a JSON array of fields | Great for one-off extractions without creating a template
    Enhanced Extract Agent | Uses a specialized agent with a reasoning model | Great for complex documents or nuanced extraction; works with structured templates or fields

    For this quickstart, we will create a Box Metadata template to define the fields we want
    to extract from our documents. This [guide](https://support.box.com/hc/en-us/articles/360044194033-Customizing-Metadata-Templates) 
    will walk you through the steps to create a Box Metadata template in the Box Admin 
    Console.

    Give your template a name. In this tutorial, we will use "Box AI extract quickstart".

    We will create the following fields:
    Field name | Field type | Field Description
    ---|---|---
    Client Name | Text | The name of the client receiving the invoice
    Invoice Amount | Number | The total amount of the invoice after taxes and fees
    Products | Text | The name of the products delivered in the invoice. Return these as a comma-delimited string.

    <Tip>
      The field description is used by Box AI to supplement the prompt to the LLM to ensure the 
      right data is extracted. Use this to your advantage.
    </Tip>

    Click "Save" to create your template. Make note of the template key, as we will need it 
    in a later step. When you save the template, you will see the list of templates. To find the template key, 
    open the template you just created and inspect the URL. The last part of the path is 
    your template key. As an example, the URL might look like this:
    `https://app.box.com/master/metadata/templates/boxAiExtractQuickstart`.
    
    In this case, the template key is `boxAiExtractQuickstart`.

  </Step>
  <Step title="Upload file">
    Now we need a file to test. We will be using this 
    [sample invoice document](/static/quickstarts/extract/files/demo-invoice-20tax-2.pdf).

    Download this file and drag and drop it into your Box account. 

    We will need the file ID for this demo. To get the file ID, open the file in Box and inspect 
    the URL. The last part of the path is your file ID. As an example, the URL might look like this:
    `https://app.box.com/file/2064123286902`
    
    In this case, the file ID is `2064123286902`.
  </Step>
  <Step title="Configure environment">
    Now we need to set up our development environment. For this quickstart, we will be using Python and the 
    Box Python SDK version 10. Make sure you have Python 3.11 or higher installed on your machine.
    1. Create a new directory for your project and navigate into it.
    2. Create a virtual environment:
       ```bash
       python3 -m venv .venv
       source .venv/bin/activate
       ```
    3. Install the Box Python SDK:
       ```bash
       pip install "boxsdk~=10"
       ```
    4. Install the `python-dotenv` package to load environment variables from the `.env` file:
       ```bash
       pip install python-dotenv
       ```
    5. Create a `.env` file in the root of your project directory and add the following 
    environment variables, replacing the placeholder values with your actual Box app credentials
    and the IDs from the previous steps:
       ```bash
        BOX_DEVELOPER_TOKEN=your_box_developer_token

        BOX_METADATA_TEMPLATE_KEY=your_metadata_template_key
        BOX_FILE_ID=your_box_file_id
       ```
    
    To get your Developer Token, go to the Box Developer Console, open your app, and navigate to 
    the `Configuration` tab. Click on `Generate Developer Token` to create a new token.   

  </Step>
  <Step title="Create extract.py">
    Now we are ready to create our Python script to extract data from the document using Box AI. 
    
    Create a new file named `extract.py` in the root of your project directory and add the following code:

    ```python
    import os

    from dotenv import load_dotenv

    from box_sdk_gen import (
        AiItemBase,
        BoxClient,
        BoxDeveloperTokenAuth,
        CreateAiExtractStructuredMetadataTemplate,
        CreateAiExtractStructuredMetadataTemplateTypeField,
        CreateFileMetadataByIdScope
    )

    load_dotenv()

    developer_token = os.getenv("BOX_DEVELOPER_TOKEN")
    file_id = os.getenv("BOX_FILE_ID")
    template_key = os.getenv("BOX_METADATA_TEMPLATE_KEY")

    def get_box_client(token: str) -> BoxClient:
        
        if not developer_token:
            raise ValueError("BOX_DEVELOPER_TOKEN is not set in environment variables.")
        
        auth = BoxDeveloperTokenAuth(token=token)
        client = BoxClient(auth=auth)

        return client

    def main():
        client = get_box_client(token=developer_token)

        me = client.users.get_user_me()
        print(f"My user ID is {me.id}")


    if __name__ == "__main__":
        main()
    ```

    In this code, we load the environment variables from the `.env` file, initialize the Box SDK client, 
    and print the current user's ID to validate that the client is working correctly.

    To run the script, execute the following command in your terminal:

    ```bash
    python extract.py
    ```

    You should see your user ID printed in the console, indicating that the Box SDK client is set up correctly.

    ```bash
    My user ID is 123456789
    ```

  </Step>
  <Step title="Extract data">
    Now that we have a working Box SDK client, we can add the code to extract data from the document using Box AI.

    Between the `get_box_client` function and the `main` function, add the following functions:

    ```python
    def extract_metadata(client: BoxClient, file_id: str, template_key: str) -> dict:
        metadata = client.ai.create_ai_extract_structured(
            [AiItemBase(id=file_id)],
            metadata_template=CreateAiExtractStructuredMetadataTemplate(
                template_key=template_key,
                type=CreateAiExtractStructuredMetadataTemplateTypeField.METADATA_TEMPLATE,
                scope="enterprise",
            ),
        )
        
        return metadata.to_dict()['answer']
    ```

    This function uses the Box AI `create_ai_extract_structured` method to extract metadata from the specified file.
    We pass the function our BoxClient, the file ID, and the metadata template key we created earlier. The
    function returns the extracted metadata as a dictionary.

    Now let's add the function call to extract the metadata in the `main` function. The new `main` function should 
    look like this:

    ```python
    def main():
        client = get_box_client(token=developer_token)

        me = client.users.get_user_me()
        print(f"My user ID is {me.id}")

        metadata = extract_metadata(client=client, file_id=file_id, template_key=template_key)

        print(f"Extracted Metadata: {metadata}")
    ```

    The SDK handles the API call to Box AI and returns the extracted metadata as an
    [`AiExtractStructuredResponse`](/reference/resources/ai-extract-structured-response) object. In our code,
    we convert this object to a dictionary and return the `answer` field, which contains the extracted
    key/value pairs.

    We will print out the extracted metadata to the console to verify that the extraction was successful.

    To run the script, execute the following command in your terminal:

    ```bash
    python extract.py
    ```

    You should see your user ID followed by the extracted metadata from the invoice document.

    ```bash
    My user ID is 123456789

    Extracted Metadata: {'clientName': 'ACME Inc', 'invoiceAmount': 1106.06, 'products': 'Polyol, Diisocyanate, 
    Carbon Dioxide, Laser, Lens, Oleic Acid, Glycerine, Sodium Tallowate, Paint Base, Polypropylene, Rubber, 
    Additive, Pigment, Aluminum Silicate, Magnesium Silicate, Zinc Oxide, Distilled Solvent, Petroleum Distillate, 
    Sulfur Dioxide, Sodium Benzoate, Dust cap, Ferrite cap, Cone and coil assembly, Cleaner, Polypropylene pellets, 
    Polypropylene chips, Polypropylene blocks, Polypropylene slag, Parts Wash Solvent, Jar, 
    Plastic Bottle - 15.2 FL Oz (450 ml), Polymer'}
    ```
  </Step>
  <Step title="Add Box Metadata to file">
    Now that you have extracted metadata from the document, you can use these key/value pairs in your
    applicationâ€”push to databases, integrate with CRMs, feed to agents for processing, or trigger automated workflows.

    This quickstart demonstrates pushing the extracted data back to Box as file metadata. Box Metadata
    enables powerful filtering and search capabilities across your content. For example, you can query
    all invoices over $500 from the last 30 days, create dashboards in Box Apps, or surface key document
    insights directly in the Box web application.

    To push the extracted metadata back to Box, add the following function between the `extract_metadata` function
    and the `main` function:

    ```python
    def push_metadata(client: BoxClient, file_id: str, metadata: dict, template_key: str) -> dict:
        attached_metadata = client.file_metadata.create_file_metadata_by_id(
            file_id,
            CreateFileMetadataByIdScope.ENTERPRISE,
            template_key,
            metadata,
        )
        return attached_metadata.to_dict()
    ```

    This function uses the `create_file_metadata_by_id` method to attach metadata to the specified file. 
    We pass in the BoxClient, file ID, metadata dictionary, and template key. The API itself returns a 
    [`MetadataFull`](/reference/resources/metadata--full) object. The function converts this object to a 
    dictionary and returns it.

    Now let's add the function call to push the metadata in the `main` function. The updated `main` function 
    should look like this:

    ```python
    def main():
        client = get_box_client(token=developer_token)

        me = client.users.get_user_me()
        print(f"My user ID is {me.id}")

        metadata = extract_metadata(client=client, file_id=file_id, template_key=template_key)

        print(f"Extracted Metadata: {metadata}")

        attached_metadata = push_metadata(client=client, file_id=file_id, metadata=metadata, template_key=template_key)

        print(f"Attached Metadata: {attached_metadata}")
    ```

3. Run the following command in your terminal:

    ```bash
    python extract.py
    ```

    If the script is successful, the console displays your user ID, the extracted metadata, and the attached metadata response from Box. For example:

    ```bash
    My user ID is 123456789

    Extracted Metadata: {'clientName': 'ACME Inc', 'invoiceAmount': 1106.06, 'products': 'Polyol, Diisocyanate,
    Carbon Dioxide, Laser, Lens, Oleic Acid, Glycerine, Sodium Tallowate, Paint Base, Polypropylene, Rubber,
    Additive, Pigment, Aluminum Silicate, Magnesium Silicate, Zinc Oxide, Distilled Solvent, Petroleum Distillate,
    Sulfur Dioxide, Sodium Benzoate, Dust cap, Ferrite cap, Cone and coil assembly, Cleaner, Polypropylene pellets,
    Polypropylene chips, Polypropylene blocks, Polypropylene slag, Parts Wash Solvent, Jar,
    Plastic Bottle - 15.2 FL Oz (450 ml), Polymer'}

    Attached Metadata: {'invoiceAmount': 1106.06, 'products': 'Polyol, Diisocyanate, Carbon Dioxide, Laser, Lens, 
    Oleic Acid, Glycerine, Sodium Tallowate, Paint Base, Polypropylene, Rubber, Additive, Pigment, Aluminum Silicate, 
    Magnesium Silicate, Zinc Oxide, Distilled Solvent, Petroleum Distillate, Sulfur Dioxide, Sodium Benzoate, Dust cap, 
    Ferrite cap, Cone and coil assembly, Cleaner, Polypropylene pellets, Polypropylene chips, Polypropylene blocks, 
    Polypropylene slag, Parts Wash Solvent, Jar, Plastic Bottle - 15.2 FL Oz (450 ml), Polymer', 
    'clientName': 'ACME Inc', '$parent': 'file_1956534287859', '$template': 'boxAiExtractQuickstart', 
    '$scope': 'enterprise_899905961', '$version': 0, '$canEdit': True, '$id': '4d4f0b55-d45a-4ba4-9ff6-1241182cb76a', 
    '$type': 'boxAiExtractQuickstart-c4024235-2384-49f4-9286-ada6d68fd6a9', '$typeVersion': 0, 'extra_data': 
    {'invoiceAmount': 1106.06, 'products': 'Polyol, Diisocyanate, Carbon Dioxide, Laser, Lens, Oleic Acid, Glycerine, 
    Sodium Tallowate, Paint Base, Polypropylene, Rubber, Additive, Pigment, Aluminum Silicate, Magnesium Silicate, 
    Zinc Oxide, Distilled Solvent, Petroleum Distillate, Sulfur Dioxide, Sodium Benzoate, Dust cap, Ferrite cap, 
    Cone and coil assembly, Cleaner, Polypropylene pellets, Polypropylene chips, Polypropylene blocks, Polypropylene slag, 
    Parts Wash Solvent, Jar, Plastic Bottle - 15.2 FL Oz (450 ml), Polymer', 'clientName': 'ACME Inc'}}
    ```
  </Step>
</Steps>

## Resources
- [Final code](https://github.com/box-community/box-ai-extract-quickstart)
- [Extract Structured Metadata API Reference](/reference/post-ai-extract-structured)
- [Create metadata instance on file](/reference/post-files-id-metadata-id-id)
- [Box SDK for Python](https://github.com/box/box-python-sdk/tree/main)